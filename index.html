<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScheduleToCalendar</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <section class="main">
        <h1>ScheduleToCalendar</h1>
        <p>Sign in with Google to get started.</p>
        <div
            id="g_id_onload"
            data-client_id="796952607356-gsj82osa6j1r7j88vca6ru08q9r5ncda.apps.googleusercontent.com"
            data-context="signin"
            data-ux_mode="popup"
            data-login_uri="https://scheduletocalendarbackend-production.up.railway.app/index.php"
            data-itp_support="true"
            data-auto_prompt="false">
        </div>

        <div
            class="g_id_signin"
            data-type="standard"
            data-shape="rectangular"
            data-theme="outline"
            data-text="signin_with"
            data-size="large"
            data-logo_alignment="center"
            data-width="300">
        </div>
    </section>

    <script>
        // Configurar el evento de carga del botón de inicio de sesión
        window.onload = function () {
            google.accounts.id.initialize({
                client_id: "796952607356-gsj82osa6j1r7j88vca6ru08q9r5ncda.apps.googleusercontent.com",
                callback: function(response) {
                    const { credential } = response;

                    // Enviar el credential al servidor (callback.php) directamente
                    fetch('https://scheduletocalendarbackend-production.up.railway.app/index.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: `credential=${credential}`,
                    })
                    .then(response => response.text())
                    .then(data => {
                        // Manejar la respuesta del servidor (puedes actualizar la interfaz de usuario, etc.)
                        console.log('Respuesta del servidor:', data);
                    })
                    .catch(error => {
                        console.error('Error al enviar el credential al servidor:', error);
                    });
                }
            });

            google.accounts.id.prompt();
        };
    </script>
</body>
</html>
